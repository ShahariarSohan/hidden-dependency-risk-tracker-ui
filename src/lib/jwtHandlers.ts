/* eslint-disable @typescript-eslint/no-explicit-any */

"use server"
import { TokenResult } from "@/types/token.interface";
import jwt, { JwtPayload } from "jsonwebtoken";

const verifiedAccessToken = async (token: string):Promise<TokenResult> => {
  const secret = process.env.ACCESS_TOKEN_SECRET 
  console.log("from jwtHandlers",secret,token)
  try {
    const verifiedPayload = await  jwt.verify(
      token,
      process.env.ACCESS_TOKEN_SECRET as string
    ) as JwtPayload;
    return {
      success: true,
      message: "Token is valid",
      payload: verifiedPayload,
    };
  } catch (err: any) {
    return {
      success: false,
      message: err.message || "Invalid token",
    };
  }
};

export default verifiedAccessToken;
